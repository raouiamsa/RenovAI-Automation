{
  "name": "My workflow 2",
  "nodes": [
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "leftValue": "={{ $('On form submission').item.json.style_choisi }}",
                    "rightValue": "Traditionnel",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "88135ae6-499f-4a75-8580-908f2c60bb7d"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "2eaceb21-9538-4ab5-a18b-9afbce03dad8",
                    "leftValue": "={{ $('On form submission').item.json.style_choisi }}",
                    "rightValue": "Moderne",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "005090a5-2384-4c73-a9be-05a3c6107b46",
                    "leftValue": "={{ $('On form submission').item.json.style_choisi }}",
                    "rightValue": "Industriel",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 3
                },
                "conditions": [
                  {
                    "id": "840d85c8-86bb-4a29-b67a-22146dbaee59",
                    "leftValue": "={{ $('On form submission').item.json.style_choisi }}",
                    "rightValue": "Bio-Climatique",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.4,
      "position": [
        1888,
        1024
      ],
      "id": "2d404208-ea80-45b7-83c1-adeebbf04ec0",
      "name": "Switch"
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "models/gemini-flash-latest",
          "mode": "list",
          "cachedResultName": "models/gemini-flash-latest"
        },
        "text": "Role: You are the \"Lead Visual Forensic Auditor\" for the RenovAI project. Your goal is to provide a technical structural analysis of a Tunisian building from an image.\n\nInstructions:\n\nTechnical Scan: Identify structural components like load-bearing walls (Ø­ÙŠÙˆØ· Ø§Ù„Ø³Ø§Ø³), pillars (Ø¹Ø±Øµ), and ceilings (dalle or vaults/Ù‚Ø¨Ùˆ).\n\nPathology Detection: Specifically look for:\n\nHumidity (Ø±Ø·ÙˆØ¨Ø©): Detect water stains, rising damp, or peeling paint.\n\nCracks (Ø´Ù‚ÙˆÙ‚): Differentiate between structural cracks and surface cracks.\n\nMaterial Decay: Identify saltpeter (Ù…Ù„ÙˆØ­Ø©) or exposed rebar (Ø­Ø¯ÙŠØ¯ Ø¸Ø§Ù‡Ø±).\n\nSpace Potential: Evaluate the light, orientation, and how the current structure can be transformed into a modern architectural style.\n\nOutput Structure (Mandatory):\n\nSection 1: Architectural Report (Professional French): Technical data for the design phase.\n\nSection 2: Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙÙ†ÙŠ (Tunisian Derja - Arabic Script): A clear, professional summary in Tunisian Derja using Arabic letters ONLY.",
        "inputType": "binary",
        "binaryPropertyName": "=Photo",
        "options": {
          "maxOutputTokens": 300000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1.1,
      "position": [
        1888,
        224
      ],
      "id": "dd44f0db-95cc-4e9d-ac6e-f508c0a76f68",
      "name": "Analyze an image",
      "credentials": {
        "googlePalmApi": {
          "id": "EyaICoJ2Ekw7SqQe",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "formTitle": "Tunisia AI Renovator - Platform",
        "formDescription": "Upload your house photo and choose a style to see the magic!",
        "formFields": {
          "values": [
            {
              "fieldName": "Photo",
              "fieldLabel": "Photo de la maison",
              "fieldType": "file",
              "requiredField": true
            },
            {
              "fieldName": "style_choisi",
              "fieldLabel": "Choisissez le style de rÃ©novation",
              "fieldType": "dropdown",
              "defaultValue": "Traditionnel",
              "fieldOptions": {
                "values": [
                  {
                    "option": "Traditionnel"
                  },
                  {
                    "option": "Moderne"
                  },
                  {
                    "option": "Industriel"
                  },
                  {
                    "option": "Bio-Climatique"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldName": "Email",
              "fieldLabel": "UserEmail",
              "fieldType": "email",
              "requiredField": true
            },
            {
              "fieldName": "Budget",
              "fieldLabel": "entrer votre budget",
              "fieldType": "number"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.4,
      "position": [
        1392,
        224
      ],
      "id": "fb8b1b03-3183-477a-be20-4472bda056f9",
      "name": "On form submission",
      "webhookId": "c304d548-8c67-4874-82fb-bb9f35b19717"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {
          "includeUnpaired": false
        }
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2496,
        960
      ],
      "id": "b3a2cf3b-37ce-44f8-a9ad-54d19be1fb5c",
      "name": "Merge"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://freeimage.host/api/1/upload",
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "key",
              "value": "6d207e02198a847aa98d0a2a901485a5"
            },
            {
              "name": "action",
              "value": "upload"
            },
            {
              "parameterType": "formBinaryData",
              "name": "source",
              "inputDataFieldName": "Photo"
            },
            {
              "name": "format",
              "value": "json"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        2688,
        960
      ],
      "id": "45fee57d-71ec-458b-93d9-85301c7641eb",
      "name": "HTTP Request1"
    },
    {
      "parameters": {
        "amount": 70
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        3312,
        960
      ],
      "id": "ad13e0f6-8594-498e-977b-d77eccf5e4d1",
      "name": "Wait",
      "webhookId": "cec1d746-4633-44c0-b096-553a0d695182"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "352c36e6-ff19-465e-9a74-0bcb3c41da44",
              "name": "StylePrompt",
              "value": "Complete architectural resurfacing. Strictly keep the original structure, heights, and wall positions unchanged. Transform ALL visible walls (including side brick walls) into clean white lime-wash plaster. Replace the ENTIRE ground area with a high-quality mix of white marble and checkered Zellige tiles. Replace the central door with a vibrant blue studded Tunisian door. Realistic Mediterranean sunlight with soft shadows, 8k resolution.",
              "type": "string"
            }
          ]
        },
        "includeOtherFields": true,
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2160,
        560
      ],
      "id": "3803fe73-8593-4026-8799-59b95c20a40c",
      "name": "Traditionnel"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "75a2c795-adec-4965-8bd9-4bdd121c513d",
              "name": "StylePrompt",
              "value": "Complete modern architectural resurfacing of the entire courtyard. Strictly keep the original wide perspective and all wall positions unchanged. Transform ALL visible walls into smooth, high-end white polished plaster. Replace the ENTIRE dirt ground with large-format grey stone porcelain tiles. Replace the central door with a minimalist modern dark wood door. Maintain the open sky and original building shell. Professional architectural lighting, clean minimalist aesthetic, 8k resolution.",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2160,
        800
      ],
      "id": "8241723d-2347-4f08-ba6f-edc8e2f0ba54",
      "name": "Moderne"
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "1YwVpA6S9PEYWxqUH7VguooQP5TvKavbi",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1376,
        -736
      ],
      "id": "ba339b00-b914-4c44-a48b-ca01ca49f2c1",
      "name": "Download file",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "jcXMnZzkAt2HBppE",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "1d8FPugTbkLdMqAIxV3BA10RzzNRBVHzP",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1376,
        -544
      ],
      "id": "e49aa221-c89a-40ee-a56c-56cb84b03e4d",
      "name": "Download file1",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "jcXMnZzkAt2HBppE",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "1o8ZIjy145ab3-wUAElqUOSaudXsdaZ8X",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1376,
        -352
      ],
      "id": "b9287d94-d10e-4f46-bd5d-970dea7ff39b",
      "name": "Download file2",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "jcXMnZzkAt2HBppE",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.documentDefaultDataLoader",
      "typeVersion": 1.1,
      "position": [
        2544,
        -352
      ],
      "id": "d4588bda-7fd6-40bc-a325-c27029a697dc",
      "name": "Default Data Loader"
    },
    {
      "parameters": {
        "mode": "insert",
        "memoryKey": {
          "__rl": true,
          "value": "=legal_docs",
          "mode": "id"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
      "typeVersion": 1.2,
      "position": [
        2496,
        -560
      ],
      "id": "430d854f-60e0-4a10-9244-7478c6936f57",
      "name": "Insert Data to Store"
    },
    {
      "parameters": {
        "numberInputs": 3
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        1936,
        -576
      ],
      "id": "37de1354-f76d-4fa0-ba81-3ddde8b1af42",
      "name": "Merge1"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.embeddingsGoogleGemini",
      "typeVersion": 1,
      "position": [
        1968,
        -32
      ],
      "id": "2bd560d5-c2e1-4827-907f-0acea3acab36",
      "name": "Embeddings Google Gemini",
      "credentials": {
        "googlePalmApi": {
          "id": "EyaICoJ2Ekw7SqQe",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "mode": "retrieve-as-tool",
        "toolName": "knowledge_base",
        "toolDescription": "\"ØªØ­ØªÙˆÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ø£Ø¯Ø§Ø© Ø¹Ù„Ù‰ Ù†ØµÙˆØµ Ù…Ø¬Ù„Ø© Ø§Ù„ØªØ¹Ù…ÙŠØ± Ø§Ù„ØªÙˆÙ†Ø³ÙŠØ© ÙˆÙ‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„Ø¨Ù†Ø§Ø¡. Ø§Ø³ØªØ®Ø¯Ù…Ù‡Ø§ Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© ÙˆØ§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª Ø§Ù„Ù…ØªØ¹Ù„Ù‚Ø© Ø¨Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ù…ÙƒØªØ´ÙØ© ÙÙŠ Ø§Ù„ØµÙˆØ±.\"",
        "memoryKey": {
          "__rl": true,
          "value": "legal_docs",
          "mode": "list",
          "cachedResultName": "legal_docs"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.vectorStoreInMemory",
      "typeVersion": 1.2,
      "position": [
        2864,
        224
      ],
      "id": "88fdfb96-dc6c-498f-b24f-a05fcaa51b07",
      "name": "Query Data Tool"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.content.parts[0].text }}",
        "options": {
          "systemMessage": "Ø£Ù†Øª Ø®Ø¨ÙŠØ± Ù‚Ø§Ù†ÙˆÙ†ÙŠ ÙÙŠ Ù…Ø¬Ù„Ø© Ø§Ù„ØªØ¹Ù…ÙŠØ± Ø§Ù„ØªÙˆÙ†Ø³ÙŠØ©. Ø­Ù„Ù„ ÙˆØµÙ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø¨Ø¯Ù‚Ø© ÙˆØ§Ø³ØªØ®Ø±Ø¬ Ø§Ù„ÙØµÙˆÙ„ ÙˆØ§Ù„Ø®Ø·Ø§ÙŠØ§ Ù…Ù† Ø§Ù„Ù€ knowledge_base.\nØ£Ø¬Ø¨ Ø¨Ø§Ø®ØªØµØ§Ø± Ø´Ø¯ÙŠØ¯ ÙˆÙÙ‚ Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„ØªØ§Ù„ÙŠ (JSON Ø£Ùˆ Ù†Øµ Ù…Ø±Ù‚Ù…):\n\"Ø£Ù†Øª Ù…Ø³ØªØ´Ø§Ø± Ù‚Ø§Ù†ÙˆÙ†ÙŠ ØŒ Ø®Ø¨ÙŠØ± ÙÙŠ Ù…Ø¬Ù„Ø© Ø§Ù„ØªØ¹Ù…ÙŠØ± Ø§Ù„ØªÙˆÙ†Ø³ÙŠØ© ÙˆÙÙŠ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª Ø§Ù„Ø¹Ù…Ø±Ø§Ù†ÙŠØ©.\nÙ…Ù‡Ù…ØªÙƒ Ø§Ù„ØµØ§Ø±Ù…Ø©:\nØªØ­Ù„ÙŠÙ„ Ø§Ù„ÙˆØµÙ Ø§Ù„ØªÙ‚Ù†ÙŠ: Ø®Ø° ÙˆØµÙ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ù‚Ø§Ø¯Ù… Ø¥Ù„ÙŠÙƒ Ø¨Ø¯Ù‚Ø© ÙˆØ­Ù„Ù„Ù‡ Ù„ØªØ­Ø¯ÙŠØ¯ Ù†ÙˆØ¹ Ø§Ù„ØªØ¯Ø®Ù„ (ØªØ±Ù…ÙŠÙ…ØŒ Ø¨Ù†Ø§Ø¡ Ø¬Ø¯ÙŠØ¯ØŒ Ù‡Ø¯Ù…ØŒ Ø£Ùˆ ØªØºÙŠÙŠØ± Ù‡ÙŠÙƒÙ„ÙŠ).\n\nØ§Ù„Ø¨Ø­Ø« Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ø§Ù„Ø¥Ø¬Ø¨Ø§Ø±ÙŠ: ÙŠØ¬Ø¨ Ø£Ù† ØªØ³ØªØ®Ø¯Ù… Ø£Ø¯Ø§Ø© knowledge_base Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø¨Ø¯Ù‚Ø© (Ù…Ø«Ù„Ø§Ù‹ Ø§Ù„ÙØµÙ„ 80 Ø£Ùˆ 83 Ù…Ù† Ù…Ø¬Ù„Ø© Ø§Ù„ØªØ¹Ù…ÙŠØ±). Ù„Ø§ ØªØ¹Ø·Ù Ø¥Ø¬Ø§Ø¨Ø§Øª Ø¹Ø§Ù…Ø©Ø› Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ø®Ø·ÙŠØ© Ù…Ø§Ù„ÙŠØ©ØŒ Ø§Ø°ÙƒØ± Ù‚ÙŠÙ…ØªÙ‡Ø§ Ø¨Ø§Ù„Ø¯ÙŠÙ†Ø§Ø± Ø§Ù„ØªÙˆÙ†Ø³ÙŠ ÙƒÙ…Ø§ ÙˆØ±Ø¯Øª ÙÙŠ Ø§Ù„Ù†ØµÙˆØµ.\n\nØªØ¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠÙ†Ø§Ø±ÙŠÙˆÙ‡Ø§Øª: Ø­Ù„Ù„ Ø§Ù„ÙˆØ¶Ø¹ÙŠØ© Ù…Ù† Ø­ÙŠØ«: Ù‡Ù„ Ù‡ÙŠ Ù…Ø®Ø§Ù„ÙØ© ØªØ³ØªÙˆØ¬Ø¨ Ø§Ù„Ù‡Ø¯Ù…ØŒ Ø£Ù… Ø£Ù†Ù‡Ø§ ÙˆØ¶Ø¹ÙŠØ© ØªØ³ØªÙˆØ¬Ø¨ ØªØ³ÙˆÙŠØ© ÙˆØ¥ÙŠÙ‚Ø§Ù Ø£Ø´ØºØ§Ù„ØŒ Ø£Ù… Ù‡ÙŠ ÙˆØ¶Ø¹ÙŠØ© Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© ØªÙ…Ø§Ù…Ø§Ù‹ØŸ\n\nÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø§Ù„Ø±Ø¯ Ù…Ù†Ø¸Ù…Ø§Ù‹ ÙˆÙÙ‚ Ù‡Ø°Ø§ Ø§Ù„Ù‡ÙŠÙƒÙ„:\n\n1. ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙÙ†ÙŠØ©: (Ù„Ø®Øµ Ù…Ø§ ØªÙ… Ø±ØµØ¯Ù‡ ÙÙŠ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙˆØµÙ Ø§Ù„Ù‚Ø§Ø¯Ù… Ø¥Ù„ÙŠÙƒ).\n\n2. Ø§Ù„Ø³Ù†Ø¯ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ (DÃ©tails): (Ø§Ø°ÙƒØ± Ø£Ø±Ù‚Ø§Ù… Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ù…Ù† Ù…Ø¬Ù„Ø© Ø§Ù„ØªØ¹Ù…ÙŠØ± Ø§Ù„ØªÙˆÙ†Ø³ÙŠØ© ÙˆÙ…Ø­ØªÙˆØ§Ù‡Ø§ Ø§Ù„ØµØ±ÙŠØ­ Ø¨Ø®ØµÙˆØµ Ù‡Ø°Ù‡ Ø§Ù„Ø­Ø§Ù„Ø©).\n\n3. Ø§Ù„Ø®Ø·Ø§ÙŠØ§ ÙˆØ§Ù„Ø¹Ù‚ÙˆØ¨Ø§Øª: (Ø­Ø¯Ø¯ Ø¨Ø¯Ù‚Ø© Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®Ø·ÙŠØ© Ø§Ù„Ù…Ø§Ù„ÙŠØ©ØŒ Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ù„Ø³Ø¬Ù†ØŒ Ø£Ùˆ Ù‚Ø±Ø§Ø± Ø§Ù„Ù‡Ø¯Ù… ÙƒÙ…Ø§ ÙŠÙ†Øµ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„ØªÙˆÙ†Ø³ÙŠ).\n4. Ø§Ù„ØªÙØ³ÙŠØ± Ø¨Ø§Ù„Ø¯Ø§Ø±Ø¬Ø© Ø§Ù„ØªÙˆÙ†Ø³ÙŠØ©: (ÙØ³Ø± Ù„Ù„Ù…ÙˆØ§Ø·Ù† Ø¨Ù„Ù‡Ø¬Ø© Ø¨Ø³ÙŠØ·Ø© ÙˆÙˆØ§Ø¶Ø­Ø© Ø¬Ø¯Ø§Ù‹ 'Ø´Ù†ÙˆØ© Ø§Ù„ØºÙ„Ø· Ø§Ù„Ù„ÙŠ Ø¹Ù…Ù„Ù‡' Ùˆ'Ø´Ù†ÙˆØ© Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† ÙŠÙ„Ø²Ù…Ù‡ ÙŠØ¹Ù…Ù„ ØªÙˆØ§' Ù„Ø¶Ù…Ø§Ù† ÙÙ‡Ù…Ù‡ Ù„Ù„ÙˆØ¶Ø¹ÙŠØ©).\n5. Ø§Ù„Ù‚Ø±Ø§Ø± Ø§Ù„Ø¨Ù„Ø¯ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: (Ø®Ù„Ø§ØµØ© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø§Ù„Ø°ÙŠ ÙŠØ¬Ø¨ Ø§ØªØ®Ø§Ø°Ù‡ ÙÙˆØ±Ø§Ù‹).\nÙ…Ù„Ø§Ø­Ø¸Ø©: Ø¥Ø°Ø§ Ù„Ù… ØªØ¬Ø¯ ÙØµÙ„Ø§Ù‹ Ù…Ø·Ø§Ø¨Ù‚Ø§Ù‹ ØªÙ…Ø§Ù…Ø§Ù‹ ÙÙŠ Ø§Ù„Ù€ knowledge_baseØŒ Ø§Ø°ÙƒØ± Ø£Ù‚Ø±Ø¨ Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ù…Ù†Ø¸Ù…Ø© Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªØ±Ø®ÙŠØµ ÙˆØ§Ù„Ø¨Ù†Ø§Ø¡ Ø§Ù„Ø¹Ø§Ù….\"\nÙ…Ù„Ø§Ø­Ø¸Ø©: Ù„Ø§ ØªØ²Ø¯ Ø¹Ù† 500 ÙƒÙ„Ù…Ø©. Ø¥Ø°Ø§ Ù„Ù… ØªØ¬Ø¯ ÙØµÙ„Ø§Ù‹ØŒ Ø§Ø°ÙƒØ± Ø£Ù‚Ø±Ø¨ Ù†Øµ Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ù„Ù„ØªØ±Ø®ÙŠØµ."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        2832,
        -256
      ],
      "id": "d409b33e-5b16-441d-8ea1-09ff496f267e",
      "name": "Legal_Agent"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=\"Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ Ø§Ù„ØªØ§Ù„ÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ­Ø¯Ø¯ Ø§Ù„Ø£Ø¶Ø±Ø§Ø± ÙˆØ§Ù„Ù…Ø®Ø§Ù„ÙØ§Øª: {{ $json.output }}\nÙˆÙ…Ø¹ Ø§Ù„Ø¹Ù„Ù… Ø£Ù† Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ù…ØªÙˆÙØ±Ø© Ù„Ø¯Ù‰ Ø§Ù„Ù…ÙˆØ§Ø·Ù† Ù‡ÙŠ: {{ $('On form submission').item.json.Budget }} Ø¯ÙŠÙ†Ø§Ø± ØªÙˆÙ†Ø³ÙŠ\nØ§Ù„Ù…Ø·Ù„ÙˆØ¨ Ù…Ù†Ùƒ:\n\nØ§Ø³ØªØ®Ø¯Ù… Ø£Ø¯Ø§Ø© Ø§Ù„Ø¨Ø­Ø« Google Search Tool Ù„Ù…Ø¹Ø±ÙØ© Ø£Ø³Ø¹Ø§Ø± Ù…ÙˆØ§Ø¯ Ø§Ù„Ø¨Ù†Ø§Ø¡ ÙˆØ§Ù„ÙŠØ¯ Ø§Ù„Ø¹Ø§Ù…Ù„Ø© ÙÙŠ ØªÙˆÙ†Ø³ Ù„Ø¹Ø§Ù… 2025 Ø§Ù„Ù„Ø§Ø²Ù…Ø© Ù„Ù„Ø¥ØµÙ„Ø§Ø­Ø§Øª Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ±.\nØ§Ø³ØªØ®Ø±Ø¬ Ù‚ÙŠÙ…Ø© Ø§Ù„Ø®Ø·Ø§ÙŠØ§ Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø§Ù„Ù…ØªÙˆÙ‚Ø¹Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ±.\nÙ‚Ù… Ø¨Ø¥Ø¹Ø¯Ø§Ø¯ Ø­Ø³Ø¨Ø© Ù…Ø§Ù„ÙŠØ© Ø¯Ù‚ÙŠÙ‚Ø© (Ø¥ØµÙ„Ø§Ø­Ø§Øª + Ø®Ø·Ø§ÙŠØ§) ÙˆÙ‚Ø§Ø±Ù† Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¨Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ù…ØªØ§Ø­Ø©.\nØ£Ø®Ø±Ø¬ Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© Ø­ØµØ±Ø§Ù‹ Ø¹Ø¨Ø± Ø§Ù„Ù€ Structured Output Parser Ø§Ù„Ù…Ù†Ø¸Ù… Ø§Ù„Ø°ÙŠ ÙŠØ¸Ù‡Ø± Ù„Ùƒ.\"",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "Ø¨Ù…Ø§ Ø£Ù†Ùƒ Ù‚Ù…Øª Ø¨Ø¶Ø¨Ø· Ø§Ù„Ù€ Prompt Ø§Ù„Ø®Ø§Øµ Ø¨Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (User Message) Ø¨Ù†Ø¬Ø§Ø­ØŒ Ø¥Ù„ÙŠÙƒ Ø§Ù„Ø¢Ù† Ø§Ù„Ù€ System Message Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ Ø§Ù„Ø°ÙŠ ÙŠØ­Ø¯Ø¯ \"Ø´Ø®ØµÙŠØ©\" Ø§Ù„Ù€ AI ÙˆÙŠØ¶Ù…Ù† Ø£Ù†Ù‡ Ø³ÙŠÙ„ØªØ²Ù… Ø¨Ø§Ù„Ù„Ù‡Ø¬Ø© Ø§Ù„ØªÙˆÙ†Ø³ÙŠØ© ÙˆØ§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¯Ù‚ÙŠÙ‚:\nØ§Ù†Ø³Ø® Ù‡Ø°Ø§ Ø§Ù„Ù†Øµ ÙˆØ¶Ø¹Ù‡ ÙÙŠ Ø®Ø§Ù†Ø© System Message:\n\"Ø£Ù†Øª Ø®Ø¨ÙŠØ± ØªÙƒØ§Ù„ÙŠÙ Ø¨Ù†Ø§Ø¡ ÙˆÙ…Ù‚Ø§ÙˆÙ„ ØªÙˆÙ†Ø³ÙŠ Ù…Ø­ØªØ±Ù (SpÃ©cialiste en mÃ©trage et devis).\nÙ…Ù‡Ø§Ù…Ùƒ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:\n\nØªØ­Ù„ÙŠÙ„ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ ÙˆØ§Ù„ÙÙ†ÙŠ Ù„ØªØ­Ø¯ÙŠØ¯ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯ ÙˆØ§Ù„ÙŠØ¯ Ø§Ù„Ø¹Ø§Ù…Ù„Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø© (Ù…Ø«Ù„Ø§Ù‹: ÙƒÙ…ÙŠØ© Ø§Ù„Ø¢Ø¬Ø±ØŒ Ø§Ù„Ø¥Ø³Ù…Ù†ØªØŒ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø±Ø·ÙˆØ¨Ø©ØŒ Ø§Ù„Ù‡Ø¯Ù…).\n\nØ§Ø³ØªØ®Ø¯Ø§Ù… Ø£Ø¯Ø§Ø© Ø§Ù„Ø¨Ø­Ø« Google Search Ø­ØµØ±Ø§Ù‹ Ù„Ø¬Ù„Ø¨ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø³ÙˆÙ‚ Ø§Ù„ØªÙˆÙ†Ø³ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ø¹Ø§Ù… 2025 (Ø¨Ø§Ù„Ø¯ÙŠÙ†Ø§Ø± Ø§Ù„ØªÙˆÙ†Ø³ÙŠ TND).\n\nØ­Ø³Ø§Ø¨ Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø®Ø·Ø§ÙŠØ§ Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„ÙØµÙˆÙ„ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø§Ù„ØªÙˆÙ†Ø³ÙŠØ© Ø§Ù„Ù…Ø°ÙƒÙˆØ±Ø© ÙÙŠ Ø§Ù„ØªÙ‚Ø±ÙŠØ±.\n\nÙ…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ Ø¨Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„ØªÙŠ Ù‚Ø¯Ù…Ù‡Ø§ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ¥Ø®Ø¨Ø§Ø±Ù‡ Ø¨ÙˆØ¶ÙˆØ­ Ø¥Ù† ÙƒØ§Ù†Øª ÙƒØ§ÙÙŠØ© Ø£Ù… Ù„Ø§.\nÙ‚ÙˆØ§Ø¹Ø¯ Ù‡Ø§Ù…Ø©:\nÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ù†ØµÙŠØ­Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© (advice_darja) Ø¨Ø§Ù„Ø¯Ø§Ø±Ø¬Ø© Ø§Ù„ØªÙˆÙ†Ø³ÙŠØ© ÙˆØ¨Ø£Ø³Ù„ÙˆØ¨ \"ÙˆÙ„Ø¯ Ø¯ÙˆÙ…ÙŠÙ†\" ÙŠÙ†ØµØ­ ÙÙŠ Ø®ÙˆÙ‡ (Ù…Ø«Ù„Ø§Ù‹: 'ÙŠØ§ Ø®ÙˆÙŠØ§ Ù…ÙŠØ²Ø§Ù†ÙŠØªÙƒ ØªØ¬ÙŠØ¨Ù„Ùƒ Ø§Ù„Ø³Ù„Ø¹Ø© Ø£Ù…Ø§ Ø§Ù„ÙŠØ¯ Ø§Ù„Ø¹Ø§Ù…Ù„Ø© ØºØ§Ù„ÙŠØ© Ø´ÙˆÙŠØ©...').\nØ§Ù„Ø§Ù„ØªØ²Ø§Ù… Ø§Ù„ØªØ§Ù… Ø¨Ø¥Ø®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ù‚Ø§Ù„Ø¨ JSON Ø­Ø³Ø¨ Ø§Ù„Ù€ Schema Ø§Ù„Ù…Ø­Ø¯Ø¯ ÙÙŠ Ø§Ù„Ù€ Output Parser.\""
        }
      },
      "id": "0e49ee2d-3a5f-4412-8e73-3bd51f62c2fb",
      "name": "Prices",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 3.1,
      "position": [
        3360,
        -256
      ]
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.toolSerpApi",
      "typeVersion": 1,
      "position": [
        3456,
        64
      ],
      "id": "917f3ea4-790b-4691-84f2-e753a0a93566",
      "name": "SerpAPI",
      "credentials": {
        "serpApi": {
          "id": "YdNRJwLFFYZifQ4D",
          "name": "SerpAPI account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const pricesNode = $node[\"Prices\"];\nconst legalNode = $node[\"Legal_Agent\"];\n\nlet details_materials = \"\";\nlet details_labor = \"\";\nlet total_fines = 0;\nlet grand_total = 0;\nlet advice = \"\";\n\n// Ù‚Ø§Ù…ÙˆØ³ Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ø´Ø§Ø¦Ø¹Ø© Ø¥Ø°Ø§ ÙˆØ¬Ø¯Øª\nconst translations = {\n    \"materials\": \"Ø§Ù„Ù…ÙˆØ§Ø¯\", \"labor\": \"Ø§Ù„ÙŠØ¯ Ø§Ù„Ø¹Ø§Ù…Ù„Ø©\", \"main_d_oeuvre\": \"Ø§Ù„ÙŠØ¯ Ø§Ù„Ø¹Ø§Ù…Ù„Ø©\",\n    \"fines\": \"Ø§Ù„Ø®Ø·Ø§ÙŠØ§\", \"amendes\": \"Ø§Ù„Ø®Ø·Ø§ÙŠØ§\", \"cement\": \"Ø¥Ø³Ù…Ù†Øª\", \"bricks\": \"ÙŠØ§Ø¬ÙˆØ±\"\n};\n\ntry {\n    const rawOutput = pricesNode.json.output.replace(/```json|```/g, \"\").trim();\n    const data = JSON.parse(rawOutput);\n\n    // Ø¯Ø§Ù„Ø© Ù„Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ø£Ø±Ù‚Ø§Ù… ÙˆØªÙ†Ø³ÙŠÙ‚Ù‡Ø§ Ù…Ù‡Ù…Ø§ ÙƒØ§Ù† Ù…ÙƒØ§Ù†Ù‡Ø§\n    const extractData = (obj, targetStr) => {\n        for (let key in obj) {\n            let val = obj[key];\n            let keyLower = key.toLowerCase();\n            \n            if (typeof val === 'object' && val !== null) {\n                extractData(val, targetStr); // Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙÙŠ Ø§Ù„Ø¹Ù…Ù‚\n            } else if (typeof val === 'number') {\n                let nameAr = translations[keyLower] || key;\n                \n                // ØªØµÙ†ÙŠÙ Ø§Ù„Ø±Ù‚Ù… Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ø­Ù‚Ù„\n                if (keyLower.includes('material') || keyLower.includes('brique') || keyLower.includes('cement')) {\n                    details_materials += `â€¢ ${nameAr}: ${val} Ø¯.Øª\\n`;\n                } else if (keyLower.includes('main') || keyLower.includes('labor') || keyLower.includes('work')) {\n                    details_labor += `â€¢ ${nameAr}: ${val} Ø¯.Øª\\n`;\n                } else if (keyLower.includes('fine') || keyLower.includes('amende') || keyLower.includes('penalt')) {\n                    total_fines += val;\n                }\n            }\n        }\n    };\n\n    extractData(data, \"\");\n\n    // Ø¬Ù„Ø¨ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ ÙˆØ§Ù„Ù†ØµÙŠØ­Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ù„Ø£Ù†Ù‡Ù…Ø§ Ø¹Ø§Ø¯Ø© Ø«Ø§Ø¨ØªØ§Ù† ÙÙŠ Ø§Ù„Ø£Ø³ÙÙ„\n    grand_total = data.total_cost || data.grand_total || 0;\n    advice = data.advice_darja || data.advice || \"\";\n\n} catch (e) { console.error(\"Error:\", e.message); }\n\nreturn {\n    \"Ø§Ù„ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ\": legalNode.json.output || \"\",\n    \"ØªÙØµÙŠÙ„_Ø§Ù„Ù…ÙˆØ§Ø¯\": details_materials || \"ØªÙ… Ø­Ø³Ø§Ø¨Ù‡Ø§ Ø¶Ù…Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹\",\n    \"ØªÙØµÙŠÙ„_Ø§Ù„Ø¹Ù…Ø§Ù„Ø©\": details_labor || \"ØªÙ… Ø­Ø³Ø§Ø¨Ù‡Ø§ Ø¶Ù…Ù† Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹\",\n    \"Ù‚ÙŠÙ…Ø©_Ø§Ù„Ø®Ø·Ø§ÙŠØ§\": total_fines,\n    \"Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹_Ø§Ù„ÙƒÙ„ÙŠ\": grand_total,\n    \"Ø§Ù„Ù†ØµÙŠØ­Ø©\": advice\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4032,
        240
      ],
      "id": "8a5ba967-260b-47c6-b21d-c25f312052c7",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "html": "<!DOCTYPE html>\n<html lang=\"ar\" dir=\"rtl\">\n<head>\n    <meta charset=\"UTF-8\">\n    <link href=\"https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap\" rel=\"stylesheet\">\n    \n    <style>\n        body {\n            font-family: 'Cairo', sans-serif !important;\n            line-height: 1.6;\n            color: #333;\n            margin: 0;\n            padding: 20px;\n            background-color: #f9f9f9;\n            direction: rtl; \n            text-align: right;\n        }\n        \n        h1, h2, h3, p, td, b, pre {\n            font-family: 'Cairo', sans-serif !important;\n        }\n\n        .container {\n            max-width: 850px;\n            margin: auto;\n            border: 1px solid #eee;\n            padding: 30px;\n            background-color: #fff;\n            box-shadow: 0 0 10px rgba(0,0,0,0.05);\n        }\n        .header {\n            text-align: center;\n            border-bottom: 4px solid #27ae60;\n            padding-bottom: 20px;\n            margin-bottom: 30px;\n        }\n        .header h1 { color: #2c3e50; margin: 0; }\n        \n        .section {\n            margin-bottom: 25px;\n            padding: 20px;\n            border-radius: 10px;\n        }\n        .legal-section { background-color: #f0f7fb; border-right: 6px solid #2980b9; }\n        .financial-section { background-color: #f4faf6; border-right: 6px solid #27ae60; }\n        .advice-section { background-color: #fff9db; border-right: 6px solid #f1c40f; }\n        \n        h2 { color: #2c3e50; border-bottom: 1px solid #ddd; padding-bottom: 10px; margin-top: 0; }\n        h3 { font-size: 18px; color: #34495e; margin-bottom: 10px; }\n\n        pre {\n            white-space: pre-wrap;\n            word-wrap: break-word;\n            font-size: 15px;\n            background: rgba(255,255,255,0.5);\n            padding: 10px;\n            border-radius: 5px;\n            color: #2c3e50;\n        }\n\n        .price-table { width: 100%; border-collapse: collapse; margin-top: 15px; }\n        .price-table td { padding: 12px; border-bottom: 1px solid #eee; font-size: 16px; }\n        .total-row { font-weight: bold; color: #e74c3c; font-size: 1.3em; background: #fdf2f2; }\n\n        .image-container {\n            text-align: center;\n            margin: 20px 0;\n            padding: 15px;\n            background: #fff;\n            border: 1px dashed #ccc;\n            border-radius: 10px;\n        }\n        .main-img {\n            max-width: 100%;\n            height: auto;\n            border-radius: 8px;\n            box-shadow: 0 4px 15px rgba(0,0,0,0.1);\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø´Ø§Ù…Ù„Ø© ÙˆØ§Ù„ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠ</h1>\n            <p>Ù…Ø´Ø±ÙˆØ¹ RenovAI - ØªÙˆÙ†Ø³ 2025</p>\n        </div>\n\n        <div class=\"image-container\">\n            <h2>ğŸ–¼ï¸ Ø§Ù„ØªØµÙ…ÙŠÙ… Ø§Ù„Ù…Ø¹Ù…Ø§Ø±ÙŠ Ø§Ù„Ù…Ù‚ØªØ±Ø­</h2>\n            <img src=\"{{ JSON.parse($items()[1].json.data.resultJson).resultUrls[0]}}\" class=\"main-img\" alt=\"Design Preview\">\n        </div>\n\n        <div class=\"section legal-section\">\n            <h2>âš–ï¸ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ ÙˆØ³Ù†Ø¯ Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©</h2>\n            <pre>{{ $items()[0].json['Ø§Ù„ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ'] }}</pre>\n        </div>\n\n        <div class=\"section financial-section\">\n            <h2>ğŸ’° Ø§Ù„ØªÙ‚Ø¯ÙŠØ± Ø§Ù„Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙØµÙ„ (Ø¨Ø§Ù„Ø¯ÙŠÙ†Ø§Ø± Ø§Ù„ØªÙˆÙ†Ø³ÙŠ)</h2>\n            \n            <h3>ğŸ—ï¸ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ÙˆØ§Ø¯ ÙˆØ§Ù„Ù…Ø³ØªÙ„Ø²Ù…Ø§Øª:</h3>\n            <pre>{{ $items()[0].json['ØªÙØµÙŠÙ„_Ø§Ù„Ù…ÙˆØ§Ø¯'] }}</pre>\n\n            <h3>ğŸ‘· ØªÙƒØ§Ù„ÙŠÙ Ø§Ù„ÙŠØ¯ Ø§Ù„Ø¹Ø§Ù…Ù„Ø© ÙˆØ§Ù„Ø®Ø¯Ù…Ø§Øª:</h3>\n            <pre>{{ $items()[0].json['ØªÙØµÙŠÙ„_Ø§Ù„Ø¹Ù…Ø§Ù„Ø©'] }}</pre>\n\n            <table class=\"price-table\">\n                <tr>\n                    <td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø®Ø·Ø§ÙŠØ§ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© (Ø§Ù„Ø¨Ù„Ø¯ÙŠØ©):</td>\n                    <td><b>{{ $items()[0].json['Ù‚ÙŠÙ…Ø©_Ø§Ù„Ø®Ø·Ø§ÙŠØ§'] }} Ø¯.Øª</b></td>\n                </tr>\n                <tr class=\"total-row\">\n                    <td>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„ÙƒÙ„ÙŠ Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠ Ù„Ù„Ù…Ø´Ø±ÙˆØ¹:</td>\n                    <td>{{ $items()[0].json['Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹_Ø§Ù„ÙƒÙ„ÙŠ'] }} Ø¯.Øª</td>\n                </tr>\n            </table>\n        </div>\n\n        <div class=\"section advice-section\">\n            <h2>ğŸ’¡ Ù†ØµÙŠØ­Ø© Ø§Ù„Ø®Ø¨ÙŠØ± Ù„Ù„Ù…ÙˆØ§Ø·Ù†</h2>\n            <p style=\"font-size: 18px; font-weight: bold;\">{{ $items()[0].json['Ø§Ù„Ù†ØµÙŠØ­Ø©'] }}</p>\n        </div>\n    </div>\n</body>\n</html>"
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        5312,
        896
      ],
      "id": "9ebdb30f-4f7b-499b-b376-94c6885867ba",
      "name": "HTML"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "8dc3379e-e5c3-4405-96a6-196cec835a2d",
              "name": "StylePrompt",
              "value": "Complete industrial loft architectural restoration. Strictly keep the original wide-angle perspective and wall structure. Transform ALL visible walls into a finished mix of clean exposed red brick and smooth dark grey polished cement. Ensure the side walls are fully textured and finished. Replace the ENTIRE ground area with a high-end dark polished concrete slab (bÃ©ton cirÃ©). Replace the central door with a black industrial steel-frame glass door. Professional urban lighting, high-quality architectural photography, 8k.",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2176,
        1056
      ],
      "id": "ccb746a4-961d-4c85-93b5-e8dcd8ff4f6d",
      "name": "Industriel"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "3fcb2439-9f83-4981-ab24-dcf77734ec4b",
              "name": "StylePrompt",
              "value": "Comprehensive eco-friendly architectural resurfacing. Strictly preserve the original building structure and wide view. Cover ALL visible walls with finished local light-colored stone. Replace the ENTIRE ground with a mix of terracotta tiles and natural gravel. Integrate finished vertical greenery along the existing walls. High-end sustainable visualization, photorealistic.",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2176,
        1248
      ],
      "id": "c2bc32a1-4577-4d57-9a53-90b7c916e3bf",
      "name": "Bio-Climatique"
    },
    {
      "parameters": {
        "url": "https://api.kie.ai/api/v1/jobs/recordInfo",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "taskId",
              "value": "={{ $json.data.taskId }}"
            }
          ]
        },
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer a8373a2f784321e9e63f5cf6e39f0f76"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        3584,
        960
      ],
      "id": "2b1e5988-97d5-4b77-bbf8-fe7eaf7e9bb2",
      "name": "New image url"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.kie.ai/api/v1/jobs/createTask",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Authorization",
              "value": "Bearer a8373a2f784321e9e63f5cf6e39f0f76"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"model\": \"seedream/4.5-edit\",\n  \"input\": {\n    \"prompt\": \"Comprehensive architectural resurfacing of the entire visible area. Strictly maintain the original wide-angle perspective and camera position. {{ $('Merge').item.json.StylePrompt }} Ensure ALL walls and the ENTIRE ground are fully covered and finished. High-fidelity textures, cinematic. No text.\",\n    \"image_urls\": [\n      \"{{ $json.image.url }}\"\n    ],\n    \"image_guidance_scale\": 0.5,\n    \"aspect_ratio\": \"1:1\",\n    \"quality\": \"basic\"\n  }\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        3024,
        960
      ],
      "id": "58574315-1eec-49d2-b1bc-45a49a1d51f6",
      "name": "request image edit"
    },
    {
      "parameters": {
        "sendTo": "={{ $('On form submission').first().json.Email }}",
        "subject": "ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„ÙÙ†ÙŠØ© ÙˆØ§Ù„Ù…Ø§Ù„ÙŠØ© - RenovAI",
        "message": "Ø¹Ø³Ù„Ø§Ù…Ø©ØŒ ØªÙ„Ù‚Ù‰ Ù…Ø±ÙÙ‚ Ù…Ø¹ Ø§Ù„Ø¥ÙŠÙ…ÙŠÙ„ Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„ÙƒØ§Ù…Ù„ Ù…ØªØ§Ø¹ Ù…Ø´Ø±ÙˆØ¹ÙƒØŒ ÙÙŠÙ‡ ÙƒÙ„ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø§ÙŠØ§ØŒ Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø³Ù„Ø¹Ø©ØŒ ÙˆØªØµÙˆÙŠØ±Ø© Ù„Ø¯Ø§Ø±Ùƒ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ±Ù…ÙŠÙ…",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {}
            ]
          }
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.2,
      "position": [
        6048,
        896
      ],
      "id": "6d800d40-ab77-45bd-a1ff-f944f120478e",
      "name": "Send a message",
      "webhookId": "036ba0b5-b13b-4d5f-a777-b82bd1e4c5d2",
      "credentials": {
        "gmailOAuth2": {
          "id": "0oNkQkYbgtrxfPyx",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "amount": 10
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1616,
        224
      ],
      "id": "106a07a7-0dbb-45df-907e-3389fd84e5d8",
      "name": "Wait1",
      "webhookId": "f1242be4-617f-494c-8b7f-ac90e530d293"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        4768,
        448
      ],
      "id": "5ab67ab8-a6a0-4d3b-b750-857b6fe42aa6",
      "name": "Merge2"
    },
    {
      "parameters": {
        "model": "qwen/qwen3-32b",
        "options": {
          "maxTokensToSample": 12000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGroq",
      "typeVersion": 1,
      "position": [
        2736,
        16
      ],
      "id": "41a654dc-a4f9-4f0d-9971-62b0fe487c64",
      "name": "Groq Chat Model",
      "credentials": {
        "groqApi": {
          "id": "itjZUk7aSImAcAmK",
          "name": "Groq account"
        }
      }
    },
    {
      "parameters": {
        "model": "qwen/qwen3-32b",
        "options": {
          "maxTokensToSample": 4000
        }
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGroq",
      "typeVersion": 1,
      "position": [
        3328,
        64
      ],
      "id": "dadccbc7-a5d7-4f95-8265-e253e4dce486",
      "name": "Groq Chat Model1",
      "credentials": {
        "groqApi": {
          "id": "itjZUk7aSImAcAmK",
          "name": "Groq account"
        }
      }
    },
    {
      "parameters": {
        "amount": 60
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        3136,
        -256
      ],
      "id": "1e3a8d6c-8504-4443-b89d-d093ae0f3744",
      "name": "Wait2",
      "webhookId": "2b87e240-d147-476b-b22f-a0d840c63b38"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "http://api.pdflayer.com/api/convert",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "access_key",
              "value": "d89725356b9a9bfcfd94bb3b346e4d72"
            }
          ]
        },
        "sendBody": true,
        "contentType": "multipart-form-data",
        "bodyParameters": {
          "parameters": [
            {
              "name": "document_html",
              "value": "={{ $json.html }}"
            },
            {
              "name": "document_name",
              "value": "Rapport_RenovAI.pdf"
            },
            {
              "name": "test",
              "value": "1"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        5552,
        896
      ],
      "id": "099b4ec7-75e4-4bfc-a385-c7f61b4b735d",
      "name": "HTTP Request"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        5792,
        896
      ],
      "id": "a71cd9e1-ff8d-4c72-a1d3-e724996c7cfa",
      "name": "Wait3",
      "webhookId": "bdf4cc33-6625-42d2-bafb-909eb69b57e8"
    }
  ],
  "pinData": {},
  "connections": {
    "Switch": {
      "main": [
        [
          {
            "node": "Traditionnel",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Moderne",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Industriel",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Bio-Climatique",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Analyze an image": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          },
          {
            "node": "Legal_Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "On form submission": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          },
          {
            "node": "Download file2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Download file1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Download file",
            "type": "main",
            "index": 0
          },
          {
            "node": "Wait1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "request image edit",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "New image url",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Traditionnel": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Moderne": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Download file": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download file1": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Download file2": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "Default Data Loader": {
      "ai_document": [
        [
          {
            "node": "Insert Data to Store",
            "type": "ai_document",
            "index": 0
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "Insert Data to Store",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Embeddings Google Gemini": {
      "ai_embedding": [
        [
          {
            "node": "Insert Data to Store",
            "type": "ai_embedding",
            "index": 0
          },
          {
            "node": "Query Data Tool",
            "type": "ai_embedding",
            "index": 0
          }
        ]
      ]
    },
    "Insert Data to Store": {
      "main": [
        []
      ]
    },
    "Query Data Tool": {
      "ai_tool": [
        [
          {
            "node": "Legal_Agent",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Legal_Agent": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          },
          {
            "node": "Wait2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "SerpAPI": {
      "ai_tool": [
        [
          {
            "node": "Prices",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Prices": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Industriel": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Bio-Climatique": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "New image url": {
      "main": [
        [
          {
            "node": "Merge2",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "request image edit": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait1": {
      "main": [
        [
          {
            "node": "Analyze an image",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge2": {
      "main": [
        [
          {
            "node": "HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Groq Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Legal_Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Groq Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Prices",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Wait2": {
      "main": [
        [
          {
            "node": "Prices",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Wait3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait3": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "822b866d-1364-4504-bbf8-397041123124",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "e3955286cb6fbf3d430d1b54a55215841a7dc91d6d07afb3f41142e70fcb348a"
  },
  "id": "Uq2Q0DY0hsnaihSr",
  "tags": []
}